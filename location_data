ruleset location_data {
    meta {
        name "Location Data"
        author "Riley Monson"
        logging off
        provides get_location_data
    }
    global {
        get_location_data = function(some_key) {
            (ent:location{some_key}.length() > 1) => ent:location{[some_key, "venue"]} | "No Value";
        }
    }
    rule display_location {
        select when web cloudAppSelected
        pre {
            my_html = <<
              <div id="content">
                Map:#{ent:location}
              </div>
            >>;
        }
        {
            SquareTag:inject_styling();
            CloudRain:createLoadPanel("Foursquare", {}, my_html);
        }
    }
    rule add_location_item {
        select when pds new_location_item
        pre {
            my_map = { event:attr("key") : event:attr("value")};
        }
        send_directive(event:attr("key")) with body = {"location" : event:attr("value")};
        fired {
            set ent:location my_map;
        }
    }
}


